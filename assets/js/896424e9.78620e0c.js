"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[6160],{4861:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>i,default:()=>u,frontMatter:()=>o,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"skill/cloudnative/ktconnect-usage","title":"k8s\u5f00\u53d1\u5de5\u5177\u4e4bKtConnect","description":"\u6982\u8ff0","source":"@site/docs/skill/cloudnative/ktconnect_usage.md","sourceDirName":"skill/cloudnative","slug":"/skill/cloudnative/ktconnect-usage","permalink":"/docs/skill/cloudnative/ktconnect-usage","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"K8S","permalink":"/docs/tags/k-8-s"},{"inline":true,"label":"KtConnect","permalink":"/docs/tags/kt-connect"}],"version":"current","lastUpdatedAt":1731528000000,"frontMatter":{"id":"ktconnect-usage","slug":"ktconnect-usage","title":"k8s\u5f00\u53d1\u5de5\u5177\u4e4bKtConnect","tags":["K8S","KtConnect"],"last_update":{"date":"2024-11-13T20:00:00.000Z"}},"sidebar":"skill","previous":{"title":"\u4e91\u539f\u751f\u6280\u672f","permalink":"/docs/category/\u4e91\u539f\u751f\u6280\u672f"}}');var c=t(6070),l=t(7092);const o={id:"ktconnect-usage",slug:"ktconnect-usage",title:"k8s\u5f00\u53d1\u5de5\u5177\u4e4bKtConnect",tags:["K8S","KtConnect"],last_update:{date:new Date("2024-11-13T20:00:00.000Z")}},i=void 0,d={},a=[{value:"\u6982\u8ff0",id:"\u6982\u8ff0",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:2},{value:"1\u3001\u4e0b\u8f7dkubectl client \u547d\u4ee4\u884c\u5de5\u5177",id:"1\u4e0b\u8f7dkubectl-client-\u547d\u4ee4\u884c\u5de5\u5177",level:3},{value:"2\u3001\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u5e76\u9a8c\u8bc1",id:"2\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u5e76\u9a8c\u8bc1",level:3},{value:"3\u3001\u914d\u7f6eK8S\u96c6\u7fa4\u7684config",id:"3\u914d\u7f6ek8s\u96c6\u7fa4\u7684config",level:3},{value:"4\u3001\u9a8c\u8bc1\u662f\u5426\u80fd\u8fde\u63a5\u5230k8s\u96c6\u7fa4",id:"4\u9a8c\u8bc1\u662f\u5426\u80fd\u8fde\u63a5\u5230k8s\u96c6\u7fa4",level:3},{value:"5\u3001\u4e0b\u8f7dktconnect\u5e76\u914d\u7f6e",id:"5\u4e0b\u8f7dktconnect\u5e76\u914d\u7f6e",level:3},{value:"6\u3001\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f",id:"6\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f",level:3},{value:"7\u3001\u542f\u52a8",id:"7\u542f\u52a8",level:3}];function r(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.h2,{id:"\u6982\u8ff0",children:"\u6982\u8ff0"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://alibaba.github.io/kt-connect/#/",children:"\u5b98\u7f51\u94fe\u63a5"})}),"\n"]}),"\n",(0,c.jsx)(n.p,{children:"KtConnect \u662f\u963f\u91cc\u5f00\u6e90\u7684\u4e00\u6b3e\u4e91\u539f\u751f\u534f\u540c\u5f00\u53d1\u6d4b\u8bd5\u89e3\u51b3\u65b9\u6848,\u65e8\u5728\u63d0\u5347\u5f00\u53d1\u8005\u5728Kubernetes \u573a\u666f\u4e0b\u7684\u672c\u5730\u5f00\u53d1\u6d4b\u8bd5\u6548\u7387,\u5b83\u901a\u8fc7\u5efa\u7acb\u672c\u5730\u5230K8S\u96c6\u7fa4\u7684\u53cc\u5411\u901a\u9053,\u5141\u8bb8\u5f00\u53d1\u8005\u5728\u672c\u5730\u76f4\u63a5\u8bbf\u95eeK8S\u96c6\u7fa4\u670d\u52a1,\u6216\u5c06K8S\u96c6\u7fa4\u7684\u6d41\u91cf\u8f6c\u53d1\u5230\u672c\u5730.\u7b80\u8a00\u4e4b,KtConnect\u662f\u9762\u5411K8S\u7684\u672c\u5730\u5f00\u53d1\u8005\u8f85\u52a9\u5de5\u5177."}),"\n",(0,c.jsx)(n.h2,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://alibaba.github.io/kt-connect/#/zh-cn/guide/downloads",children:"\u4e0b\u8f7d\u94fe\u63a5"})}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"1\u4e0b\u8f7dkubectl-client-\u547d\u4ee4\u884c\u5de5\u5177",children:"1\u3001\u4e0b\u8f7dkubectl client \u547d\u4ee4\u884c\u5de5\u5177"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:(0,c.jsx)(n.a,{href:"https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.22.md#v1222",children:"\u94fe\u63a5"})}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"2\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u5e76\u9a8c\u8bc1",children:"2\u3001\u914d\u7f6e\u73af\u5883\u53d8\u91cf\u5e76\u9a8c\u8bc1"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"kubectl version --client\n\n############PS#####################\n\ue62a JHC142: C:\\ [\ue235 base 3.12.4]\u276f kubectl version --client\nClient Version: v1.29.2\nKustomize Version: v5.0.4-0.20230601165947-6ce0bf390ce3\n"})}),"\n",(0,c.jsx)(n.h3,{id:"3\u914d\u7f6ek8s\u96c6\u7fa4\u7684config",children:"3\u3001\u914d\u7f6eK8S\u96c6\u7fa4\u7684config"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\u5c06k8s\u96c6\u7fa4\u7684config\u914d\u7f6e\u6587\u4ef6\u62f7\u8d1d\u5230",(0,c.jsx)(n.code,{children:"C:\\Users\\xxxx\\.kube"})," \u6587\u4ef6\u5939\u4e2d"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"4\u9a8c\u8bc1\u662f\u5426\u80fd\u8fde\u63a5\u5230k8s\u96c6\u7fa4",children:"4\u3001\u9a8c\u8bc1\u662f\u5426\u80fd\u8fde\u63a5\u5230k8s\u96c6\u7fa4"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"kubectl cluster-info\n\n############PS#####################\n\ue62a JHC142: C:\\ [\ue235 base 3.12.4] \u276f kubectl cluster-info\nKubernetes control plane is running at https://172.x.x.x:6443\nCoreDNS is running at https://172.16.2.129:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n\nTo further debug and diagnose cluster problems, use 'kubectl cluster-info dump'.\n"})}),"\n",(0,c.jsx)(n.h3,{id:"5\u4e0b\u8f7dktconnect\u5e76\u914d\u7f6e",children:"5\u3001\u4e0b\u8f7dktconnect\u5e76\u914d\u7f6e"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u4e0b\u8f7d kt connect \u5e76\u5c06\u5176\u653e\u5230\u548ckubectl client \u7684\u540c\u4e00\u4e2a bin\u76ee\u5f55\u4e0b"}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"6\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f",children:"6\u3001\u9a8c\u8bc1\u662f\u5426\u5b89\u88c5\u6210\u529f"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:"ktctl -v\n\n############PS#####################\n\ue62a JHC142: C:\\ [\ue235 base 3.12.4] \u276f ktctl -v\nktctl version 0.3.7\n"})}),"\n",(0,c.jsx)(n.h3,{id:"7\u542f\u52a8",children:"7\u3001\u542f\u52a8"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"\u4f7f\u7528\u7ba1\u7406\u5458\u542f\u52a8Powershell,\u5e76\u542f\u52a8kt-connect"}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-bash",children:'ktctl connect -n <namespace name> --excludeIps 172.16.2.0/24   # <\u7f51\u5173\u5730\u5740\u9700\u8981\u66f4\u6362\u6210\u4e3a\u81ea\u5df1\u7684\n\n############PS#####################\n\ue62a JHC142: C:\\ [\ue235 base 3.12.4] \u276f ktctl connect -n bluewhale-platform --excludeIps 172.16.2.0/24\n4:15PM INF Using cluster context kubernetes-admin@kubernetes (kubernetes)\n4:15PM INF KtConnect 0.3.7 start at 22548 (windows amd64)\n4:15PM INF Fetching cluster time ...\n4:15PM INF Using tun2socks mode\n4:15PM INF Successful create config map kt-connect-shadow-odtnt\n4:15PM INF Deploying shadow pod kt-connect-shadow-odtnt in namespace bluewhale-platform\n4:15PM INF Waiting for pod kt-connect-shadow-odtnt ...\n4:15PM INF Pod kt-connect-shadow-odtnt is ready\n4:15PM INF Port forward local:10441 -> pod kt-connect-shadow-odtnt:22 established\n4:15PM INF Socks proxy established\n2024/08/23 16:15:17 Using existing driver 0.14\n2024/08/23 16:15:17 Creating adapter\n4:15PM INF Tun device KtConnectTunnel is ready\n2024/08/23 16:15:17 Removed orphaned adapter "KtConnectTunnel 1"\n4:15PM INF Adding route to 10.96.0.0/16\n4:15PM INF Adding route to 100.90.254.0/24\n4:15PM INF Adding route to 100.82.112.0/24\n4:15PM INF Adding route to 100.85.170.0/24\n4:15PM INF Adding route to 100.103.44.0/24\n4:15PM INF Route to tun device completed\n4:15PM INF Setting up dns in local mode\n4:15PM INF Port forward local:45198 -> pod kt-connect-shadow-odtnt:53 established\n4:15PM INF Setup local DNS with upstream [tcp:127.0.0.1:45198 udp:172.16.1.117:53]\n4:15PM INF Creating udp dns on port 53\n4:15PM INF ---------------------------------------------------------------\n4:15PM INF  All looks good, now you can access to resources in the kubernetes cluster\n4:15PM INF ---------------------------------------------------------------\n\n'})})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(r,{...e})}):r(e)}},7092:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>i});var s=t(758);const c={},l=s.createContext(c);function o(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:o(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);
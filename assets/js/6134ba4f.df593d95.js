"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[7364],{4178:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"skill/modelops/kserve-deploy","title":"Kserve\u4e4bRawDeployment\u6a21\u5f0f\u90e8\u7f72","description":"\u524d\u7f6e\u8bf4\u660e","source":"@site/docs/skill/modelops/kserve_deploy.md","sourceDirName":"skill/modelops","slug":"/skill/modelops/kserve-deploy","permalink":"/docs/skill/modelops/kserve-deploy","draft":false,"unlisted":false,"tags":[{"inline":true,"label":"Kserve","permalink":"/docs/tags/kserve"},{"inline":true,"label":"ModelOps","permalink":"/docs/tags/model-ops"},{"inline":true,"label":"K8S","permalink":"/docs/tags/k-8-s"}],"version":"current","lastUpdatedAt":1731717688000,"frontMatter":{"id":"kserve-deploy","slug":"kserve-deploy","title":"Kserve\u4e4bRawDeployment\u6a21\u5f0f\u90e8\u7f72","tags":["Kserve","ModelOps","K8S"],"keywords":["Kserve","ModelOps","K8S"],"last_update":{"date":"2024-11-16T00:41:28.000Z"}},"sidebar":"skill","previous":{"title":"\u5173\u4e8eModelOps\u7684\u76f8\u5173\u6280\u672f","permalink":"/docs/skill/modelops/modelops-common-tech"},"next":{"title":"\u4e91\u539f\u751f\u6280\u672f","permalink":"/docs/category/\u4e91\u539f\u751f\u6280\u672f"}}');var l=s(6070),i=s(7092);const t={id:"kserve-deploy",slug:"kserve-deploy",title:"Kserve\u4e4bRawDeployment\u6a21\u5f0f\u90e8\u7f72",tags:["Kserve","ModelOps","K8S"],keywords:["Kserve","ModelOps","K8S"],last_update:{date:new Date("2024-11-16T00:41:28.000Z")}},a=void 0,o={},c=[{value:"\u524d\u7f6e\u8bf4\u660e",id:"\u524d\u7f6e\u8bf4\u660e",level:2},{value:"\u4f9d\u8d56\u7ec4\u4ef6",id:"\u4f9d\u8d56\u7ec4\u4ef6",level:2},{value:"ingress-nginx \u90e8\u7f72",id:"ingress-nginx-\u90e8\u7f72",level:3},{value:"CertManager \u90e8\u7f72",id:"certmanager-\u90e8\u7f72",level:3},{value:"kserve \u90e8\u7f72",id:"kserve-\u90e8\u7f72",level:2},{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u6d4b\u8bd5",id:"\u6d4b\u8bd5",level:3}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.h2,{id:"\u524d\u7f6e\u8bf4\u660e",children:"\u524d\u7f6e\u8bf4\u660e"}),"\n",(0,l.jsx)(n.p,{children:"Kserve \u6709\u591a\u79cd\u5b89\u88c5\u90e8\u7f72\u6a21\u5f0f\uff0c\u5305\u62ec Serverless\u3001ModelMesh \u4ee5\u53ca Kubernetes Deployment\uff0c\u4e0b\u6587\u7684\u5b89\u88c5\u6a21\u578b\u91c7\u7528\u7684  Kubernetes Deployment \u4e2d\u7684 RawDeployment \u6a21\u5f0f\uff0c\u5176\u4ed6\u5b89\u88c5\u8be6\u89c1\u5b98\u65b9\u6587\u6863\uff0c"}),"\n",(0,l.jsx)(n.p,{children:"\u5b98\u65b9\u6587\u6863\u63d0\u5230\u5b89\u88c5 Kserve \u9700\u8981\u4f9d\u8d56 Istio \u548c Cert Manager\u3001\u7531\u4e8e Isito \u7ec4\u4ef6\u6bd4\u8f83\u91cd\u4e14\u4e0d\u592a\u4e86\u89e3\uff0c\u8003\u8651\u5230\u6211\u7684\u76ee\u6807\u662f\u4e3a\u4e86\u5feb\u901f\u5b8c\u6210 kserve \u7684\u90e8\u7f72\uff0c\u6240\u4ee5\u5c31\u4f7f\u7528 Ingress-nginx \u6765\u66ff\u4ee3\u4e86 Istio\uff0c\u6548\u679c\u662f\u4e00\u6837\u3002\u53e6\u5916\u5b89\u88c5\u65f6\u9700\u8981\u6ce8\u610f\u7248\u672c\u5bf9\u5e94\u5173\u7cfb"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"K8s"}),(0,l.jsx)(n.th,{children:"v1.29.7"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://github.com/kserve/kserve/releases/download/v0.10.0/",children:"KServe"})}),(0,l.jsx)(n.td,{children:"v0.13.0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.a,{href:"https://cert-manager.io/docs/",children:"Cert-manager"})}),(0,l.jsx)(n.td,{children:"v1.15.3"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.a,{href:"https://kubernetes.github.io/ingress-nginx/deploy/#quick-start",children:"Ingress-nginx"}),"\uff08",(0,l.jsx)(n.a,{href:"https://github.com/kubernetes/ingress-nginx#supported-versions-table",children:"\u4e0ek8s\u7248\u672c\u5bf9\u5e94\u5173\u7cfb"}),"\uff09"]}),(0,l.jsx)(n.td,{children:"v4.11.2"})]})]})]}),"\n",(0,l.jsx)(n.h2,{id:"\u4f9d\u8d56\u7ec4\u4ef6",children:"\u4f9d\u8d56\u7ec4\u4ef6"}),"\n",(0,l.jsx)(n.h3,{id:"ingress-nginx-\u90e8\u7f72",children:"ingress-nginx \u90e8\u7f72"}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:["\u8be5\u7ec4\u4ef6\u91c7\u7528",(0,l.jsx)(n.a,{href:"https://helm.sh/",children:" Helm"})," \u5b89\u88c5"]}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://kubernetes.github.io/ingress-nginx/deploy/",children:"\u5b98\u65b9\u6587\u6863"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://github.com/kubernetes/ingress-nginx/releases",children:"\u5b89\u88c5\u5305\u94fe\u63a5"})}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5982\u679c\u5728\u5916\u7f51\u72b6\u6001\u826f\u597d\u65f6\uff0c\u53ef\u4ee5\u91c7\u7528\u5728\u7ebf\u5b89\u88c5\uff0c\u7531\u4e8e\u5f53\u524d\u662f\u516c\u53f8\u5185\u7f51\uff0c\u6240\u4ee5\u91c7\u7528\u5c06 helm \u5b89\u88c5\u5305\u4e0b\u8f7d\u4e0b\u6765\uff0c\u8fdb\u884c\u79bb\u7ebf\u5b89\u88c5"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u6dfb\u52a0repo\nhelm repo add ingress-nginx https://kubernetes.github.io/ingress-nginx\n\n# \u4e0b\u8f7dingress-nginx.tgz\nwget https://github.com/kubernetes/ingress-nginx/releases/download/helm-chart-4.11.2/ingress-nginx-4.11.2.tgz\n\n# \u89e3\u538b\ntar -zxf ingress-nginx-4.11.2.tgz\n\n# \u5b89\u88c5\nhelm install ingress-nginx ./ingress-nginx --namespace ingress-nginx --create-namespace\n\n\n# \u7531\u4e8eingress-nginx\u4f9d\u8d56\u7684\u955c\u50cf\u88ab\u5899\u65e0\u6cd5\u4e0b\u8f7d\uff0c\u6240\u4ee5\u9700\u8981\u66f2\u7ebf\u6551\u56fd\uff0c\u4e3b\u8981\u5220\u9664value.yaml\u4e2d\u7684\u955c\u50cfhash,\u9700\u8981\u5728\u6267\u884c\u8282\u70b9\u4e0b\u8f7d\ndocker pull k8s.kubesre.xyz/ingress-nginx/kube-webhook-certgen:v1.4.3\ndocker tag k8s.kubesre.xyz/ingress-nginx/kube-webhook-certgen:v1.4.3 registry.k8s.io/ingress-nginx/kube-webhook-certgen:v1.4.3\n\ndocker pull k8s.kubesre.xyz/ingress-nginx/controller:v1.11.2\ndocker tag k8s.kubesre.xyz/ingress-nginx/controller:v1.11.2 registry.k8s.io/ingress-nginx/controller:v1.11.2\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5b89\u88c5\u6210\u529f\u540e\u6ee1\u523b\u770b\u5230\u5982\u4e0b\u4fe1\u606f"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"(base) [root@node77 ingress-nginx]# helm install ingress-nginx ./ingress-nginx --namespace ingress-nginx\nNAME: ingress-nginx\nLAST DEPLOYED: Fri Aug 30 19:34:39 2024\nNAMESPACE: ingress-nginx\nSTATUS: deployed\nREVISION: 1\nTEST SUITE: None\nNOTES:\nThe ingress-nginx controller has been installed.\nIt may take a few minutes for the load balancer IP to be available.\nYou can watch the status by running 'kubectl get service --namespace ingress-nginx ingress-nginx-controller --output wide --watch'\n\nAn example Ingress that makes use of the controller:\n  apiVersion: networking.k8s.io/v1\n  kind: Ingress\n  metadata:\n    name: example\n    namespace: foo\n  spec:\n    ingressClassName: nginx\n    rules:\n      - host: www.example.com\n        http:\n          paths:\n            - pathType: Prefix\n              backend:\n                service:\n                  name: exampleService\n                  port:\n                    number: 80\n              path: /\n    # This section is only required if TLS is to be enabled for the Ingress\n    tls:\n      - hosts:\n        - www.example.com\n        secretName: example-tls\n\nIf TLS is enabled for the Ingress, a Secret containing the certificate and key must also be provided:\n\n  apiVersion: v1\n  kind: Secret\n  metadata:\n    name: example-tls\n    namespace: foo\n  data:\n    tls.crt: <base64 encoded cert>\n    tls.key: <base64 encoded key>\n  type: kubernetes.io/tls\n(base) [root@node77 ingress-nginx]# kubectl get service --namespace ingress-nginx ingress-nginx-controller --output wide --watch\nNAME                       TYPE           CLUSTER-IP    EXTERNAL-IP   PORT(S)                      AGE   SELECTOR\ningress-nginx-controller   LoadBalancer   10.96.1.190   <pending>     80:32702/TCP,443:32064/TCP   37s   app.kubernetes.io/component=controller,app.kubernetes.io/instance=ingress-nginx,app.kubernetes.io/name=ingress-nginx\n"})}),"\n",(0,l.jsx)(n.h3,{id:"certmanager-\u90e8\u7f72",children:"CertManager \u90e8\u7f72"}),"\n",(0,l.jsxs)(n.p,{children:["\u672c\u7ec4\u4ef6\u91c7\u7528 YAML \u65b9\u5f0f\u5b89\u88c5\uff0c\u82e5\u4f7f\u7528 Helm \u5b89\u88c5\uff0c\u8bf7\u53c2\u8003\uff1a",(0,l.jsx)(n.a,{href:"https://cert-manager.io/docs/installation/helm/",children:"Link"})]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://cert-manager.io/docs/installation/kubectl/",children:"\u6587\u6863\u5730\u5740"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://artifacthub.io/packages/helm/cert-manager/cert-manager",children:"\u4e0b\u8f7d\u5730\u5740"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl apply -f https://github.com/cert-manager/cert-manager/releases/download/v1.15.3/cert-manager.yaml\n\n(base) [root@node77 cert-manager]# kubectl get pods --namespace cert-manager\nNAME                                       READY   STATUS    RESTARTS   AGE\ncert-manager-cainjector-5fd6444f95-rbczx   1/1     Running   0          80s\ncert-manager-d894bbbd4-zd8ns               1/1     Running   0          80s\ncert-manager-webhook-869674f96f-cgp92      1/1     Running   0          80s\n"})}),"\n",(0,l.jsx)(n.h2,{id:"kserve-\u90e8\u7f72",children:"kserve \u90e8\u7f72"}),"\n",(0,l.jsx)(n.h3,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.a,{href:"https://kserve.github.io/website/latest/",children:"\u6587\u6863\u5730\u5740"}),"\uff1a \u5f53\u524d\u6700\u65b0\u7248\u672c v0.13.0"]}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"https://kserve.github.io/website/latest/admin/kubernetes_deployment/",children:"\u5b89\u88c5\u6307\u5357"})}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'kubectl apply -f https://github.com/kserve/kserve/releases/download/v0.13.0/kserve.yaml\n\nkubectl apply -f https://github.com/kserve/kserve/releases/download/v0.13.0/kserve-cluster-resources.yaml\n\n# \u4fee\u6539 inferenceservice-config \u7684\u90e8\u7f72\u6a21\u578b\u4e3a RawDeployment\nkubectl patch configmap/inferenceservice-config -n kserve --type=strategic -p \'{"data": {"deploy": "{\\"defaultDeploymentMode\\": \\"RawDeployment\\"}"}}\'\n\n\n# \u5c06kserve.yaml\u4e2dingressClassName\u7684\u503c\u4fee\u6539\u4e3anginx\uff0c\u9ed8\u8ba4\u503c\u4e3aistio\ningress: |-\n{\n    "ingressClassName" : "nginx",\n}\n\n'})}),"\n",(0,l.jsx)(n.h3,{id:"\u6d4b\u8bd5",children:"\u6d4b\u8bd5"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsx)(n.li,{children:"\u65b0\u5efa\u4e00\u4e2a Namespace"}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u4e0d\u8981\u653e\u5728\u9ed8\u8ba4 namespace \u4e0b\uff0c\u5f88\u91cd\u8981\u5f88\u5173\u952e\uff0c"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"kubectl create namespace test\n"})}),"\n",(0,l.jsxs)(n.ol,{start:"2",children:["\n",(0,l.jsx)(n.li,{children:"\u521b\u5efa\u4e00\u4e2a inferenceservice"}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u5b98\u65b9\u7684\u6848\u4f8b\u7684 yaml \u4e2d\uff0c\u5e76\u6ca1\u6709\u6307\u5b9a namespace\uff0c\u5982\u679c\u6267\u884c\u4e0b\u5217\u547d\u4ee4\u5c31\u4f1a\u521b\u5efa\u5230\u9ed8\u8ba4 namespace \u4e0b\uff0c\u540e\u7eed\u90e8\u7f72\u6a21\u578b\u5c31\u4f1a\u9047\u5230\u95ee\u9898\uff0c\u8be5\u95ee\u9898\u6392\u67e5\u4e86\u597d\u4e45\u3002"}),"\n"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u5b98\u7f51\u793a\u4f8b"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'kubectl apply -n test -f - <<EOF\napiVersion: "serving.kserve.io/v1beta1"\nkind: "InferenceService"\nmetadata:\n  name: "sklearn-iris"\nspec:\n  predictor:\n    model:\n      modelFormat:\n        name: sklearn\n      storageUri: "gs://kfserving-examples/models/sklearn/1.0/model"\nEOF\n\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u5bf9\u4e0a\u8ff0\u5185\u5bb9\u8fdb\u884c\u4fee\u6539\u3002","\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u65b0\u5efa yaml \u6587\u4ef6(sklearn-iris-model.yaml)"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:'apiVersion: "serving.kserve.io/v1beta1"\nkind: "InferenceService"\nmetadata:\n  name: "sklearn-iris-1"\n  namespace: "test"  # \u8fd9\u4e2a\u5f88\u5173\u952e\u5f88\u91cd\u8981\nspec:\n  predictor:\n    model:\n      modelFormat:\n        name: sklearn\n      storageUri: "http://172.16.x.xx:9999/model.joblib"\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u7531\u4e8e\u5b98\u65b9\u7ed9\u7684\u793a\u4f8b\u7684\u6a21\u578b\u5b58\u50a8\u5728 gs \u4e0a\uff0c\u4e00\u822c\u60c5\u51b5\u4e0b\u65e0\u6cd5\u76f4\u63a5\u4e0b\u8f7d\uff0c\u6211\u4e2a\u4eba\u7684\u89e3\u51b3\u65b9\u6cd5\u662f\u590d\u5236storageUri \u7684\u5730\u5740\uff08models/sklearn/1.0/model\uff09\uff0c\u70b9\u5f00",(0,l.jsx)(n.a,{href:"https://storage.googleapis.com/kfserving-examples/",children:"\u5e73\u53f0\u4e0b\u8f7d\u94fe\u63a5"}),"\u7684\u540e\uff0c\u5c06\u8def\u5f84\u62fc\u5728\u540e\u9762\u8fdb\u884c\u4e0b\u8f7d\u5230\u672c\u5730\uff08\u9700\u8981\u6ce8\u610f\uff0c\u9700\u8981\u4e0b\u8f7d\u8be5\u6a21\u578b\u524d\u7f00\u4e0b\u7684\u6240\u6709\u8d44\u6e90\uff0c\u5e76\u653e\u5230\u4e00\u4e2a\u6587\u4ef6\u5939\u4e0b\uff09\uff0c\u7136\u540e\u5728\u4e0a\u4f20\u5230\u90e8\u7f72\u7684\u73af\u5883\u4e2d\u3002\n",(0,l.jsx)(n.img,{src:s(877).A+"",width:"847",height:"988"})]}),"\n"]}),"\n",(0,l.jsxs)(n.ol,{start:"3",children:["\n",(0,l.jsx)(n.li,{children:"\u5728\u6a21\u578b\u6587\u4ef6\u5939\u4e0b\uff0c\u542f\u52a8\u4e00\u4e2a httpserver"}),"\n"]}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsx)(n.p,{children:"\u8be5\u6b65\u9aa4\u975e\u5fc5\u987b\uff0c\u5982\u679c\u53ef\u4ee5\u76f4\u63a5\u4ece gs \u4e0b\uff0c\u5219\u5ffd\u7565\u8fd9\u4e00\u6b65\u3002\u542f\u52a8\u5916\u90e8\u670d\u52a1\u7684\u76ee\u7684\u662f\u80fd\u591f\u8ba9 kserve \u80fd\u591f\u53bb\u4e0b\u8f7d\u6a21\u578b"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'(base) [root@node77 test-kserve-deploy]# python -m http.server 9999\nServing HTTP on 0.0.0.0 port 9999 (http://0.0.0.0:9999/) ...\n127.0.0.1 - - [03/Sep/2024 12:19:13] "GET / HTTP/1.1" 200 -\n\n(base) [root@node77 kserve]# curl 127.0.0.1:9999\n<!DOCTYPE HTML>\n<html lang="en">\n<head>\n<meta charset="utf-8">\n<title>Directory listing for /</title>\n</head>\n<body>\n<h1>Directory listing for /</h1>\n<hr>\n<ul>\n<li><a href="mlflow-iris.yml">mlflow-iris.yml</a></li>\n<li><a href="mlflow-wine-model.yaml">mlflow-wine-model.yaml</a></li>\n<li><a href="mlflow_wine/">mlflow_wine/</a></li>\n<li><a href="mlflow_wine.zip">mlflow_wine.zip</a></li>\n<li><a href="my_model/">my_model/</a></li>\n<li><a href="my_model.zip">my_model.zip</a></li>\n<li><a href="python_env.yaml">python_env.yaml</a></li>\n<li><a href="python_model.pkl">python_model.pkl</a></li>\n<li><a href="sklearn_iris/">sklearn_iris/</a></li>\n<li><a href="tmp/">tmp/</a></li>\n</ul>\n<hr>\n</body>\n</html>\n(base) [root@node77 kserve]#\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u6267\u884c yaml \u6587\u4ef6"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# \u5728\u6b64\u76ee\u5f55\u4e0b\n(base) [root@node77 sklearn_iris]# ls\nmodel.joblib  sklearn-iris-model.yaml\n\n# \u6267\u884c\u547d\u4ee4\nkubectl apply -f sklearn-iris-model.yaml\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u67e5\u770b\u6a21\u578b\u90e8\u7f72\u72b6\u6001"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"(base) [root@node77 sklearn_iris]# kubectl get all -n test\nNAME                                            READY   STATUS    RESTARTS   AGE\npod/sklearn-iris-1-predictor-84d48876bb-wvlm7   1/1     Running   0          40s\n\nNAME                               TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)   AGE\nservice/sklearn-iris-1-predictor   ClusterIP   10.96.0.243   <none>        80/TCP    40s\n\nNAME                                       READY   UP-TO-DATE   AVAILABLE   AGE\ndeployment.apps/sklearn-iris-1-predictor   1/1     1            1           40s\n\nNAME                                                  DESIRED   CURRENT   READY   AGE\nreplicaset.apps/sklearn-iris-1-predictor-84d48876bb   1         1         1       40s\n\nNAME                                                           REFERENCE                             TARGETS         MINPODS   MAXPODS   REPLICAS   AGE\nhorizontalpodautoscaler.autoscaling/sklearn-iris-1-predictor   Deployment/sklearn-iris-1-predictor   <unknown>/80%   1         1         1          40s\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u67e5\u770b inferenceservice \u72b6\u6001"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"(base) [root@node77 sklearn_iris]# kubectl get inferenceservice -n test\nNAME             URL                                      READY   PREV   LATEST   PREVROLLEDOUTREVISION   LATESTREADYREVISION   AGE\nsklearn-iris-1   http://sklearn-iris-1-test.example.com   True                                                                  5m48s\n"})}),"\n",(0,l.jsx)(n.p,{children:"\u4f7f\u7528 ingress \u6d4b\u8bd5"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u67e5\u770b ingress-nginx \u8bbf\u95ee\u5730\u5740"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"(base) [root@node77 sklearn_iris]# kubectl get svc -n test\nNAME                       TYPE        CLUSTER-IP    EXTERNAL-IP   PORT(S)   AGE\nsklearn-iris-1-predictor   ClusterIP   10.96.0.243   <none>        80/TCP    7m2s\n"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7f16\u5199\u8f93\u5165\u53c2\u6570 \u6587\u4ef6\uff0cinput.json"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-json",children:'{\n  "instances": [\n    [6.8,  2.8,  4.8,  1.4],\n    [6.0,  3.4,  4.5,  1.6]\n  ]\n}\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"\u7f16\u5199\u6d4b\u8bd5\u811a\u672c"}),"\n"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n\n# nginx ingress \u7684\u8bbf\u95ee\u5730\u5740\nINGRESS_HOST=10.96.0.243\nINGRESS_PORT=80\n\nMODEL_NAME=sklearn-iris-1\nINPUT_PATH=@./input.json\n\nSERVICE_HOSTNAME=$(kubectl get inferenceservice ${MODEL_NAME} -o jsonpath=\'{.status.url}\' | cut -d "/" -f 3)\n\n# \u4f7f\u7528 curl \u53d1\u8d77\u8bf7\u6c42\ncurl -H "Content-Type: application/json" -H "Host: ${SERVICE_HOSTNAME}" http://${INGRESS_HOST}:${INGRESS_PORT}/v1/models/$MODEL_NAME:predict -d $INPUT_PATH\n\n'})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\u6267\u884c\u6d4b\u8bd5 ",(0,l.jsx)(n.code,{children:"sh -x infer_test.sh"})]}),"\n",(0,l.jsx)(n.li,{children:"\u6d4b\u8bd5\u7ed3\u679c\u5982\u4e0b\u56fe"}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{src:s(6475).A+"",width:"1860",height:"938"})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(d,{...e})}):d(e)}},877:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/kserve_model_download-af7064fef525bfd3553a74f7f38e39b5.png"},6475:(e,n,s)=>{s.d(n,{A:()=>r});const r=s.p+"assets/images/kserve_test-1ab6b04b29b04fa6b1c561eeceaa059a.png"},7092:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var r=s(758);const l={},i=r.createContext(l);function t(e){const n=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);